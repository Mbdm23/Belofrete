<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Etiqueta de Envio</title>
<link href="https://fonts.googleapis.com/css2?family=Overpass:wght@400;600&display=swap" rel="stylesheet">
<style>
body {font-family: 'Overpass', sans-serif; background-color: #f4f4f4; margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; height: 100vh;}
.form-container {width: 100%; max-width: 400px; padding: 20px; background-color: #FFF; border-radius: 10px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); text-align: center;}
.form-container h2 {margin-bottom: 20px; color: #FF9000;}
.form-container label {display: block; font-weight: 600; margin: 10px 0 5px;}
.form-container input[type="text"], .form-container input[type="number"], .form-container select {padding: 10px; margin: 5px 0 15px; width: calc(100% - 22px); border: 1px solid #ccc; border-radius: 5px; font-size: 16px;}
.form-container button {background-color: #FF9000; color: white; border: none; padding: 15px; width: 100%; cursor: pointer; border-radius: 5px; font-size: 16px; transition: background-color 0.3s;}
.form-container button:hover {background-color: #FFB74D;}
.etiqueta {border: 2px solid #FF9000; padding: 20px; margin: 10px 0; background-color: #FFF8E1; border-radius: 10px; box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.1); position: relative;}
.etiqueta img {position: absolute; top: 10px; left: 10px; width: 50px; height: auto;}
.etiqueta-info {font-size: 16px; margin-bottom: 10px;}
@media print {button {display: none;}}
</style>
</head>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";></script>
<script>
<script type="module">
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries
  const firebaseConfig = {
    apiKey: "AIzaSyApES4UQ7BuyM2o17_PJmC-EhWpuXzrQfk",
    authDomain: "belofretes-87759.firebaseapp.com",
    projectId: "belofretes-87759",
    storageBucket: "belofretes-87759.appspot.com",
    messagingSenderId: "48608880965",
    appId: "1:48608880965:web:db4dc71d40ef78835d362c"
  };
  const app = initializeApp(firebaseConfig);
</script>
<body>
<div class="form-container">
<a href="https://ibb.co/CwyPRn2"><img src="https://i.ibb.co/CwyPRn2/0-B60211-A-E021-4593-A76-E-2-D48-F65-D3-D20.png" alt="0-B60211-A-E021-4593-A76-E-2-D48-F65-D3-D20" border="0"></a>
<h2>Gerar Etiqueta de Envio</h2>
<form id="etiquetaForm">
<label for="cliente">Nome do Cliente:</label>
<input type="text" id="cliente" required>
<label for="endereco">Endereço de Retirada:</label>
<input type="text" id="endereco" required>
<label for="cidadeRetirada">Cidade de Retirada:</label>
<select id="cidadeRetirada" required>
<option value="Serra Branca">Serra Branca</option>
<option value="Rio de Janeiro">Rio de Janeiro</option>
<option value="São Paulo">São Paulo</option>
</select>
<label for="destinatario">Destinatário:</label>
<input type="text" id="destinatario" required>
<label for="cidadeDestino">Cidade de Destino:</label>
<select id="cidadeDestino" required>
<option value="Serra Branca">Serra Branca</option>
<option value="Rio de Janeiro">Rio de Janeiro</option>
<option value="São Paulo">São Paulo</option>
</select>
<label for="volumes">Quantidade de Volumes:</label>
<input type="number" id="volumes" required>
<button type="button" onclick="gerarEtiqueta()">Gerar Etiqueta</button>
</form>
<div id="etiquetaContainer"></div>
</div>
<script>
let serialNumbers = new Set();
function gerarNumeroSerial() {
  let serial;
  do { serial = Math.floor(Math.random() * 1000000); } while (serialNumbers.has(serial));
  serialNumbers.add(serial);
  return serial;
}
function gerarEtiqueta() {
  const cliente = document.getElementById('cliente').value;
  const endereco = document.getElementById('endereco').value;
  const cidadeRetirada = document.getElementById('cidadeRetirada').value;
  const destinatario = document.getElementById('destinatario').value;
  const cidadeDestino = document.getElementById('cidadeDestino').value;
  const volumes = document.getElementById('volumes').value;
  const numeroSerial = gerarNumeroSerial();

  const etiqueta = {
    cliente: cliente,
    endereco: endereco,
    cidadeRetirada: cidadeRetirada,
    destinatario: destinatario,
    cidadeDestino: cidadeDestino,
    volumes: volumes,
    numeroSerial: numeroSerial
  };

  // Salvar no Firestore
  db.collection("etiquetas").add(etiqueta)
    .then((docRef) => {
      console.log("Documento escrito com ID: ", docRef.id);
      renderEtiqueta(etiqueta);
    })
    .catch((error) => {
      console.error("Erro adicionando documento: ", error);
    });
}

function renderEtiqueta(etiqueta) {
  const etiquetaHTML = `<div class="etiqueta">
    <a href="https://ibb.co/CwyPRn2"><img src="https://i.ibb.co/CwyPRn2/0-B60211-A-E021-4593-A76-E-2-D48-F65-D3-D20.png" alt="0-B60211-A-E021-4593-A76-E-2-D48-F65-D3-D20" border="0"></a>
    <p class="etiqueta-info"><strong>Nome do Cliente:</strong> ${etiqueta.cliente}</p>
    <p class="etiqueta-info"><strong>Endereço de Retirada:</strong> ${etiqueta.endereco}</p>
    <p class="etiqueta-info"><strong>Cidade de Retirada:</strong> ${etiqueta.cidadeRetirada}</p>
    <p class="etiqueta-info"><strong>Destinatário:</strong> ${etiqueta.destinatario}</p>
    <p class="etiqueta-info"><strong>Cidade de Destino:</strong> ${etiqueta.cidadeDestino}</p>
    <p class="etiqueta-info"><strong>Quantidade de Volumes:</strong> ${etiqueta.volumes}</p>
    <p class="etiqueta-info"><strong>Número Serial:</strong> ${etiqueta.numeroSerial}</p>
    <button onclick="printEtiqueta(this.parentElement)">Imprimir Etiqueta</button>
  </div>`;

  document.getElementById('etiquetaContainer').innerHTML += etiquetaHTML;
}
function printEtiqueta(etiquetaDiv) {
  const printWindow = window.open('', '', 'width=600,height=400');
  printWindow.document.write('<html><head><title>Etiqueta de Envio</title><link href="https://fonts.googleapis.com/css2?family=Overpass:wght@400;600&display=swap" rel="stylesheet"><style>body { font-family: "Overpass", sans-serif; }.etiqueta { border: 2px solid #FF9000; padding: 20px; margin: 10px; background-color: #FFF8E1; border-radius: 10px; box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.1); position: relative; }.etiqueta img { position: absolute; top: 10px; left: 10px; width: 50px; height: auto; }@media print { button { display: none; } }</style></head><body>');
  printWindow.document.write(etiquetaDiv.outerHTML);
  printWindow.document.close();
  printWindow.print();
}
</script>
</body>
</html>
